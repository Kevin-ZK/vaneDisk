
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Oracle Database Setup &mdash; ownCloud Server Administration Manual 8.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '8.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <link rel="top" title="ownCloud Server Administration Manual 8.1 documentation" href="../index.html" />
    <link rel="up" title="Database Configuration" href="index.html" />
    <link rel="next" title="Maintenance" href="../maintenance/index.html" />
    <link rel="prev" title="Database Configuration" href="linux_database_configuration.html" />
<script type="text/javascript">
(function () {
  /**
   * Patch TOC list.
   *
   * Will mutate the underlying span to have a correct ul for nav.
   *
   * @param $span: Span containing nested UL's to mutate.
   * @param minLevel: Starting level for nested lists. (1: global, 2: local).
   */
  var patchToc = function ($ul, minLevel) {
    var findA;

    // Find all a "internal" tags, traversing recursively.
    findA = function ($elem, level) {
      var level = level || 0,
        $items = $elem.find("> li > a.internal, > ul, > li > ul");

      // Iterate everything in order.
      $items.each(function (index, item) {
        var $item = $(item),
          tag = item.tagName.toLowerCase(),
          pad = 15 + ((level - minLevel) * 10);

        if (tag === 'a' && level >= minLevel) {
          // Add to existing padding.
          $item.css('padding-left', pad + "px");
          console.log(level, $item, 'padding-left', pad + "px");
        } else if (tag === 'ul') {
          // Recurse.
          findA($item, level + 1);
        }
      });
    };

    console.log("HERE");
    findA($ul);
  };

  $(document).ready(function () {
    // Add styling, structure to TOC's.
    $(".dropdown-menu").each(function () {
      $(this).find("ul").each(function (index, item){
        var $item = $(item);
        $item.addClass('unstyled');
      });
      $(this).find("li").each(function () {
        $(this).parent().append(this);
      });
    });

    // Patch in level.
    patchToc($("ul.globaltoc"), 2);
    patchToc($("ul.localtoc"), 2);

    // Enable dropdown.
    $('.dropdown-toggle').dropdown();
  });
}());
</script>

  </head>
  <body>
  

<div class="container">
  <div class="content">
    <div class="page-header">
      <h1><a href="../contents.html">ownCloud Server Administration Manual</a></h1>

    </div>
    
			<div class="row">
				<div class="span3">
					<div class="sidebar">
						<div class="well">
							<div class="menu-support-container">
								<ul id="menu-support" class="menu">
									<ul>
										
<li><a href="../contents.html">Table of Contents</a></li>
									</ul>
                  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">ownCloud 8.1 Server Administration Manual Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">ownCloud 8.1 Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new_admin.html">What&#8217;s New for Admins in ownCloud 8.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_user/index.html">User Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_files/index.html">File Sharing and Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration_server/index.html">ownCloud Server Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Database Configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="db_conversion.html">Converting Database Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="linux_database_configuration.html">Database Configuration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Oracle Database Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#outline-of-steps">Outline of Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-oracle">Configuring Oracle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure-owncloud">Configure ownCloud</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../maintenance/index.html">Maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operations/index.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../issues/index.html">Issues and Troubleshooting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_installation/index.html">Enterprise Subscription Installation (ES Only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_clients/index.html">Creating Branded ownCloud Clients (ES only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_external_storage/index.html">External Storage (ES only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_user_management/index.html">User Management (ES only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise_files_drop/index.html">Enabling Anonymous Uploads with Files Drop (ES Only)</a></li>
</ul>

								</ul>
							</div>
						</div>
					</div>
				</div>
        

				<div class="span9">
					<div class="page-content">
						
  <div class="section" id="oracle-database-setup">
<h1>Oracle Database Setup<a class="headerlink" href="#oracle-database-setup" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>This document will cover the setup and preparation of the ownCloud server to
support the use of Oracle as a backend database.  For the purposes of testing,
we are using Oracle Enterprise Linux as both the Web server that
will host ownCloud, and as a host for the Oracle Database.</p>
<div class="section" id="outline-of-steps">
<h2>Outline of Steps<a class="headerlink" href="#outline-of-steps" title="Permalink to this headline">¶</a></h2>
<p>This document will cover the following steps:</p>
<ul class="simple">
<li>Setup of the ownCloud user in Oracle: This involves setting up a user space
in Oracle for setting up the ownCloud database.</li>
<li>Installing the Oracle Instant Client on the web server (facilitating the
connection to the Oracle Database).</li>
<li>Compiling and installing the Oracle PHP Plugin oci8 module</li>
<li>Pointing ownCloud at the Oracle database in the initial setup process</li>
</ul>
<p>The document assumes that you already have your Oracle instance running, and
have provisioned the needed resources. It also assumes that you have installed
ownCloud with all of the prerequisites.</p>
</div>
<div class="section" id="configuring-oracle">
<h2>Configuring Oracle<a class="headerlink" href="#configuring-oracle" title="Permalink to this headline">¶</a></h2>
<div class="section" id="setting-up-the-user-space-for-owncloud">
<h3>Setting up the User Space for ownCloud<a class="headerlink" href="#setting-up-the-user-space-for-owncloud" title="Permalink to this headline">¶</a></h3>
<p>Step one, if it has not already been completed by your <abbr title="DataBase Administrator">DBA</abbr>, provision a user
space on the Oracle instance for ownCloud.  This can be done by logging in as a
DBA and running the script below:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">USER</span> <span class="n">owncloud</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="n">password</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">USER</span> <span class="n">owncloud</span> <span class="k">DEFAULT</span> <span class="n">TABLESPACE</span> <span class="n">users</span> <span class="k">TEMPORARY</span> <span class="n">TABLESPACE</span> <span class="n">temp</span> <span class="n">QUOTA</span> <span class="n">unlimited</span> <span class="k">ON</span> <span class="n">users</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">create</span> <span class="k">session</span><span class="p">,</span> <span class="k">create</span> <span class="k">table</span><span class="p">,</span> <span class="k">create</span> <span class="k">procedure</span><span class="p">,</span> <span class="k">create</span> <span class="n">sequence</span><span class="p">,</span> <span class="k">create</span> <span class="k">trigger</span><span class="p">,</span> <span class="k">create</span> <span class="k">view</span><span class="p">,</span> <span class="k">create</span> <span class="n">synonym</span><span class="p">,</span> <span class="k">alter</span> <span class="k">session</span> <span class="k">TO</span> <span class="n">owncloud</span><span class="p">;</span>
</pre></div>
</div>
<p>Substitute an actual password for <tt class="docutils literal"><span class="pre">password</span></tt>.  Items like TableSpace, Quota etc. will be determined by your DBA.</p>
</div>
<div class="section" id="downloading-and-installing-the-oracle-instant-client">
<h3>Downloading and Installing the Oracle Instant Client<a class="headerlink" href="#downloading-and-installing-the-oracle-instant-client" title="Permalink to this headline">¶</a></h3>
<p>As our example system is Oracle Enterprise Linux, it is
necessary to go to the Oracle site and download the <a class="reference external" href="http://www.oracle.com/technetwork/database/features/instant-client/index-097480.html">Oracle Instant Client</a> for
your OS Distribution.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Download the instant client and the instant client SDK and place them
in a directory on the server, in this example they are RPM packages.</p>
</div>
<ul class="simple">
<li>Install the basic client from the RPM.  Use the <tt class="docutils literal"><span class="pre">rpm</span> <span class="pre">–ivh</span></tt> command</li>
<li>Install the SDK RPM package.  Use the <tt class="docutils literal"><span class="pre">rpm</span> <span class="pre">–ivh</span></tt> command</li>
</ul>
<p>At this point, the Oracle Instant client is installed on the ownCloud Host (in
the home directory).</p>
</div>
<div class="section" id="install-the-oci8-php-extension">
<h3>Install the OCI8 PHP Extension:<a class="headerlink" href="#install-the-oci8-php-extension" title="Permalink to this headline">¶</a></h3>
<p>The next step is to compile and install the OCI8 PHP extension for connectivity to the Oracle Database.</p>
<ul>
<li><p class="first">Create a folder for these bits on your server.</p>
</li>
<li><p class="first">Download the latest version of the extension from <a class="reference external" href="http://pecl.php.net/package/oci8">http://pecl.php.net/package/oci8</a>.</p>
</li>
<li><p class="first">Unpack the OCI8 PHP extension and copy it over to the server.</p>
</li>
<li><dl class="first docutils">
<dt>There should be two things in the folder:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">package.xml</span></tt> file</li>
<li><tt class="docutils literal"><span class="pre">oci8-*.*.*</span></tt> folder (folder will change based on version of the extension you downloaded).</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Build the OCI8 module.</dt>
<dd><ul class="first last">
<li><p class="first">Change (<tt class="docutils literal"><span class="pre">cd</span></tt>) to the folder where you have copied the downloaded and uncompressed OCI8 bits.</p>
</li>
<li><p class="first">Run the following command (there will be a significant amount of output):</p>
<div class="highlight-python"><pre>pecl build</pre>
</div>
</li>
</ul>
</dd>
</dl>
<ul class="simple">
<li>Eventually the output will stop and ask for the <em>Oracle Home Directory</em>, just press enter.</li>
</ul>
</li>
<li><p class="first">Change directory:</p>
<div class="highlight-python"><pre>cd oci8-&lt;version number&gt;</pre>
</div>
</li>
<li><p class="first">Type the following command:</p>
<div class="highlight-python"><pre>./configure –with-oci8=instantcleint,/usr/lib/oracle/&lt;version number&gt;/client64/lib</pre>
</div>
</li>
<li><p class="first">Again, there will be significant output</p>
</li>
<li><p class="first">Enter the following command to compile: <tt class="docutils literal"><span class="pre">make</span></tt></p>
</li>
<li><p class="first">At this time there should be a folder called modules in the <tt class="docutils literal"><span class="pre">oci8-&lt;version_&gt;</span></tt> folder.
Within this folder exists the <tt class="docutils literal"><span class="pre">oci8.so</span></tt> file.</p>
</li>
<li><p class="first">Copy this to the directory where the modules are stored in the PHP install. It depends on
your distribution. This is the path for RHEL 6 and OEL 6:</p>
<div class="highlight-python"><pre>cp oci8.so /usr/lib64/php/modules</pre>
</div>
</li>
<li><dl class="first docutils">
<dt>Create an <tt class="docutils literal"><span class="pre">.ini</span></tt> file</dt>
<dd><ul class="first last">
<li><p class="first">Navigate to the <tt class="docutils literal"><span class="pre">php.d</span></tt> directory: <tt class="docutils literal"><span class="pre">cd</span> <span class="pre">/etc/php.d</span></tt></p>
</li>
<li><p class="first">Edit a file called oci8.ini: <tt class="docutils literal"><span class="pre">vi</span> <span class="pre">oci8.ini</span></tt></p>
</li>
<li><p class="first">Make the file look as follows:</p>
<div class="highlight-python"><pre>; Oracle Instant Client Shared Object
extension=oci8.so</pre>
</div>
</li>
<li><p class="first">Save the document</p>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
</div>
<div class="section" id="configure-owncloud">
<h2>Configure ownCloud<a class="headerlink" href="#configure-owncloud" title="Permalink to this headline">¶</a></h2>
<p>The next step is to configure the ownCloud instance to point to the Oracle Database, again this document assumes
that ownCloud has previously been installed.</p>
<div class="section" id="configuration-wizard">
<h3>Configuration Wizard<a class="headerlink" href="#configuration-wizard" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/oracle-1.png" src="../_images/oracle-1.png" style="width: 5.778in; height: 7.4165in;" />
<div class="section" id="database-user">
<h4>Database user<a class="headerlink" href="#database-user" title="Permalink to this headline">¶</a></h4>
<p>This is the user space created in step 2.1.
In our Example this would be owncloud.</p>
</div>
<div class="section" id="database-password">
<h4>Database password<a class="headerlink" href="#database-password" title="Permalink to this headline">¶</a></h4>
<p>Again this is defined in the script from section 2.1 above, or pre-configured and provided to you by your DBA.</p>
</div>
<div class="section" id="database-name">
<h4>Database Name<a class="headerlink" href="#database-name" title="Permalink to this headline">¶</a></h4>
<p>Represents the database or the service that has been pre-configured on the TSN Listener on the Database Server.
This should also be provided by the DBA.
In this example, the default setup in the Oracle install was orcl (there is a TSN Listener entry for orcl on our database server).</p>
<p>This is not like setting up with MySQL or SQL Server, where a database based on the name you give is created.
The oci8 code will call this specific service and it must be active on the TSN Listener on your Oracle Database server.</p>
</div>
<div class="section" id="database-table-space">
<h4>Database Table Space<a class="headerlink" href="#database-table-space" title="Permalink to this headline">¶</a></h4>
<p>Provided by the DBA.
In this example the users table space (as is seen in the user creation script above), was used.</p>
</div>
</div>
<div class="section" id="configuration-file">
<h3>Configuration File<a class="headerlink" href="#configuration-file" title="Permalink to this headline">¶</a></h3>
<p>Assuming all of the steps have been followed to completion, the first run wizard should complete successfully, and an operating instance of ownCloud should appear.</p>
<p>The configuration file should look something like this:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="nv">$CONFIG</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span>
<span class="s1">&#39;instanceid&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;abcdefgh&#39;</span><span class="p">,</span>
<span class="s1">&#39;passwordsalt&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;01234567890123456789&#39;</span><span class="p">,</span>
<span class="s1">&#39;datadirectory&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/var/data&#39;</span><span class="p">,</span>
<span class="s1">&#39;dbtype&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;oci&#39;</span><span class="p">,</span>
<span class="s1">&#39;version&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;8.1.x.y&#39;</span><span class="p">,</span>
<span class="s1">&#39;dbname&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;orcl&#39;</span><span class="p">,</span>
<span class="s1">&#39;dbhost&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;192.168.1.57&#39;</span><span class="p">,</span>
<span class="s1">&#39;dbtableprefix&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;oc_&#39;</span><span class="p">,</span>
<span class="s1">&#39;dbuser&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;owncloud1&#39;</span><span class="p">,</span>
<span class="s1">&#39;dbpassword&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;********&#39;</span><span class="p">,</span>
<span class="s1">&#39;installed&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>


					</div>
				</div>
			</div>
    
  </div>
</div>
  </body>
</html>